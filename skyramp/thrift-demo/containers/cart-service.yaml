containers:
  - name: cart-service
    image:
      repository: public.ecr.aws/j1n2c2p2/microservices-demo/cartservice
      tag: v0.3.9
    dependencies:
      - redis
    services:
      - cart-service-port50000
    envs:
      REDIS_ADDR: "redis:6379"

services:
  - name: cart-service-port50000
    port: 50000
    secure: false
    thriftOptions:
      protocol: "binary"
      buffered: true
      http: true
      framed: false
    endpoints:
      - CartService
    protocol: thrift

endpoints:
  - name: CartService
    defined:
      name: CartService
      path: "thrift/demo.thrift"
    methods:
      - name: AddItem
      - name: EmptyCart
      - name: GetCart
        responseValue: GetCartResponse

responseValues:
  - name: GetCartResponse
    blob: |
      {
        "user_id": "abcde",
        "items": [
          {
            "product_id": "OLJCESPC7w",
            "quantity": 2
          },
          {
            "product_id": "1YMWWN1N40",
            "quantity": 1
          },
          {
            "product_id": "66VCHSJNUP",
            "quantity": 3
          }
        ]
      }
