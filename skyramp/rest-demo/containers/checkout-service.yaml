containers:
  - name: checkout-service
    image:
      repository: public.ecr.aws/j1n2c2p2/microservices-demo/checkoutservice
      tag: v0.4.0
    dependencies:
      - email-service
      - payment-service
      - shipping-service
      - product-catalog-service
    services:
      - checkout-service-port60000
    envs:
      PRODUCT_CATALOG_SERVICE_ADDR: "product-catalog-service:3550"
      SHIPPING_SERVICE_ADDR: "shipping-service:50051"
      PAYMENT_SERVICE_ADDR: "payment-service:50051"
      EMAIL_SERVICE_ADDR: "email-service:5000"
      CURRENCY_SERVICE_ADDR: "currency-service:7000"
      CART_SERVICE_ADDR: "cart-service:7070"
      DISABLE_TRACING: "1"
      DISABLE_PROFILER: "1"

services:
  - name: checkout-service-port60000
    port: 60000
    secure: false
    protocol: rest
    endpoints:
      - checkout-service

endpoints:
  - name: checkout-service
    path: "/checkout"
    methods:
      - type: 'POST'
        name: checkout-service-post
        responseValue: PlaceOrderResult

responseValues:
  - name: PlaceOrderResult
    blob: |
      {
        "order_id": "order-id-e2646f58-417a-11ed-b878-0242ac120002",
        "shipping_tracking_id": "tracking-id-5f32af7c-799e-404e-9dc3-42be5461bad5",
        "shipping_code": {
          "currency_code": "USD",
          "units": 100,
          "nanos": 99000000
        },
        "shipping_address": {
          "street_address": "1600 Amp street",
          "city": "Mountain View",
          "state": "CA",
          "country": "USA",
          "zip_code": 95043
        },
        "items": [
          {
            "item": {
              "product_id": "66VCHSJNUP",
              "quantity": 3
            },
            "cost": {
              "currency_code": "USD",
              "units": 17,
              "nanos": 99000000
            }
          },
          {
             "item": {
              "product_id": "66VCHSJNUP",
              "quantity": 3
            },
            "cost": {
              "currency_code": "USD",
              "units": 17,
              "nanos": 99000000
            }
         }
        ]
      }
